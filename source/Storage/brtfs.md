# 7.17. 基于BTRFS 后段
存储池类型： btrfs

从表面上看，这种存储类型与目录类型非常相似，因此请参阅目录后端部分以获得一般介绍。

两者主要区别在于这种存储类型的raw磁盘将被放置在一个子卷中，以便允许快照并支持离线存储迁移并保留快照。

注意：	BTRFS 在打开文件时将遵循 O_DIRECT标志，这意味着 VM 不应使用缓存（建议为none），否则会出现校验和错误。

## 7.17.1 配置
此后端的配置类似于目录存储。请注意，当添加一个目录作为 BTRFS 存储时，它本身并不是挂载点，强烈建议通过is_mountpoint选项指定实际的挂载点。

例如，如果一个 BTRFS 文件系统挂载在/mnt/data2，并且它的子目录`pve-storage`（可能是快照）应该添加为一个名为data2的存储池，如下：

```
btrfs: data2 
        path /mnt/data2/pve-storage 
        content rootdir,images 
        is_mountpoint /mnt/data2
```

## 7.17.2. 快照

拍摄子卷或raw文件的快照时，快照将创建为具有相同路径的只读子卷，后跟@和快照的名称。


## 7.17.3. 存储功能


## 表 15. Btrfs的存储功能 （官方未正式说明）

|数据类型 |镜像格式 |支持共享| 支持快照 |支持链接克隆|
|-----|-----|-----|----|-----|
|磁盘映像 容器 片段 vzdump备份 ISO镜像 容器模板 | raw |否|是|是|
