# 7.11基于LVM的后端存储

存储池类型：lvm

LVM是建立在硬盘设备和分区之上的一个轻量级存储层软件。LVM可将硬盘空间划分为多个小的逻辑卷。LVM在Linux上得到了广泛应用，并大大简化了硬盘管理操作。

另一种方式使用LVM管理大的iSCSI LUN。这样可以轻松实现iSCSI LUN的空间分配，否则，在iSCSI本身不提供空间分配接口的情况下，这将是一个不可能完成的任务。

## 7.11.1配置方法

LVM后端存储支持公共存储服务属性content、nodes、disable，以及如下的LVM特有属性：

- vgname

用于设置LVM的卷组（VG）名称。必须设置为已有卷组
的名称。

- base

用于标识基本卷。基本卷必须在访问存储之前就自动激活。该属性常用在远端iSCSI服务器上的LVM卷组。

- saferemove

用于标识删除逻辑卷时同步擦除数据。设置该属性后，删除逻辑卷时，LVM将确保所有数据被物理擦除。

- saferemove_throughput
用于设置擦除数据块大小。 ( 即cstream –t参数值).

配置示例（`/etc/pve/storage.cfg`）

```
lvm: myspace
vgname myspace
content rootdir,images
```


## 7.11.2文件命名规范

LVM后端存储的命名规范与ZFS后端存储基本一致。

vm-<VMID>-<NAME> 	//普通虚拟机镜像

## 7.11.3存储功能

LVM是典型的块存储解决方案，但LVM后端存储本身不支持快照和链接克隆功能。更不幸的是，在创建普通LVM快照期间，整个卷组的写操作都会受到影响而变得非常低效。

最大的好处是你可以在共享存储上建立LVM后端存储服务。例如可以在iSCSI LUN上建立LVM。LVM后端存储自带Proxmox VE集群锁以有效防止并发访问冲突。

提示:最新的LVM-thin后端存储提供了快照和链接克隆功能，但不支持在共享存储上使用。


表 10.后端 lvm 的存储功能

|数据类型 |镜像格式 |支持共享| 支持快照 |支持链接克隆|
|-----|-----|-----|----|-----|
|虚拟机镜像 容器镜像 |raw |可能|否|否|

## 7.11.4. 例子
列出可用的卷组：

```
pvesm lvmscan
```
